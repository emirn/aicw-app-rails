<h2 class="text-xl font-semibold tracking-tight text-foreground">Two-Factor Authentication</h2>
<p class="mt-1 text-sm text-muted-foreground">
  Enter the 6-digit code from your authenticator app
</p>

<%# TOTP entry form %>
<%= form_with url: verify_totp_path, method: :post, data: { turbo: false }, class: "mt-6" do |f| %>
  <div class="space-y-4">
    <div>
      <%= f.label :totp_code, "Authenticator code", class: "block text-sm font-medium text-foreground mb-1" %>
      <%= f.text_field :totp_code, autofocus: true, autocomplete: "one-time-code", inputmode: "numeric", pattern: "[0-9]{6}", maxlength: 6, required: true, class: "w-full rounded-md border border-input bg-background px-3 py-3 text-center text-lg font-mono tracking-[0.3em] text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring", placeholder: "000000" %>
      <p class="mt-1.5 text-xs text-muted-foreground">
        Or enter one of your backup codes
      </p>
    </div>

    <div>
      <%= f.submit "Verify", class: "w-full rounded-md bg-primary px-4 py-2.5 text-sm font-medium text-primary-foreground transition hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-ring cursor-pointer" %>
    </div>
  </div>
<% end %>

<%# Footer link %>
<div class="mt-6 text-center text-sm text-muted-foreground">
  <%= link_to "Back to sign in", new_user_session_path, class: "font-medium text-primary hover:text-primary/80" %>
</div>
